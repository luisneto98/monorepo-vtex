# Story 1.1: Setup Inicial do Projeto

## Status
Draft

## Story
**As a** desenvolvedor,
**I want** configurar a estrutura base do monorepo com NestJS,
**so that** tenhamos um ambiente de desenvolvimento padronizado.

## Acceptance Criteria
1. Monorepo configurado com workspaces para backend, web e mobile
2. NestJS instalado com estrutura modular (auth, content, common)
3. MongoDB/Mongoose configurado com conexão para MongoDB Atlas
4. ESLint e Prettier configurados com regras consistentes
5. Scripts npm para desenvolvimento, build e teste funcionando
6. README com instruções de setup local

## Tasks / Subtasks
- [ ] Task 1: Configure monorepo structure (AC: 1)
  - [ ] Initialize root package.json with npm/yarn workspaces
  - [ ] Create directory structure following architecture spec: apps/api, apps/web, apps/mobile, apps/admin, packages/shared, packages/ui
  - [ ] Configure root tsconfig.json with path mappings for shared packages
  - [ ] Set up shared TypeScript configuration in packages/shared

- [ ] Task 2: Set up NestJS backend (AC: 2)
  - [ ] Initialize NestJS project in apps/api directory
  - [ ] Create modular structure with modules: auth, sessions, speakers, sponsors, users, notifications
  - [ ] Configure common folder with decorators, filters, guards, interceptors
  - [ ] Set up main.ts with CORS, validation pipe, and global exception filters

- [ ] Task 3: Configure MongoDB connection (AC: 3)
  - [ ] Install @nestjs/mongoose and mongoose dependencies
  - [ ] Create database configuration module with environment variables
  - [ ] Implement Mongoose schemas for User, Session, Speaker, and Sponsor models
  - [ ] Set up connection to MongoDB Atlas with proper connection string handling
  - [ ] Add indexes for optimized queries on frequently accessed fields

- [ ] Task 4: Set up linting and formatting (AC: 4)
  - [ ] Configure ESLint with TypeScript support across all workspaces
  - [ ] Set up Prettier with consistent formatting rules
  - [ ] Add pre-commit hooks using husky for automatic linting
  - [ ] Ensure lint scripts work at both root and workspace levels

- [ ] Task 5: Configure development scripts (AC: 5)
  - [ ] Add root scripts for running all applications concurrently
  - [ ] Configure individual workspace scripts for dev, build, test
  - [ ] Set up nodemon/ts-node-dev for hot reloading in development
  - [ ] Add Docker Compose configuration for local MongoDB if needed

- [ ] Task 6: Create comprehensive README (AC: 6)
  - [ ] Document prerequisites (Node.js, npm/yarn versions)
  - [ ] Provide step-by-step local setup instructions
  - [ ] Include environment variables template (.env.example)
  - [ ] Add troubleshooting section and development workflow guide

- [ ] Task 7: Write unit tests for initial setup
  - [ ] Create test structure in apps/api/tests following testing strategy
  - [ ] Write basic tests for MongoDB connection
  - [ ] Set up Jest configuration with proper coverage thresholds
  - [ ] Ensure test scripts are working properly

## Dev Notes

### Technology Stack
Based on architecture specifications, the following technologies must be used:
- **TypeScript**: Version 5.0+ for type-safe development [Source: architecture/tech-stack.md#11]
- **NestJS**: Version 10.0+ as backend framework [Source: architecture/tech-stack.md#13]
- **MongoDB**: Version 6.0+ with Mongoose for data persistence [Source: architecture/tech-stack.md#15]
- **Redis**: Version 7.0+ for caching (setup connection but implementation in later stories) [Source: architecture/tech-stack.md#16]
- **Jest**: Version 29+ for testing framework [Source: architecture/tech-stack.md#18-19]
- **Docker & Docker Compose**: For containerization [Source: architecture/tech-stack.md#24]

### Project Structure Requirements
The monorepo must follow this exact structure [Source: architecture/unified-project-structure.md]:
```
vtexday26/
├── apps/
│   ├── api/          # NestJS backend
│   │   ├── src/
│   │   │   ├── modules/
│   │   │   │   ├── auth/
│   │   │   │   ├── sessions/
│   │   │   │   ├── speakers/
│   │   │   │   ├── sponsors/
│   │   │   │   ├── users/
│   │   │   │   └── notifications/
│   │   │   ├── common/
│   │   │   │   ├── decorators/
│   │   │   │   ├── filters/
│   │   │   │   ├── guards/
│   │   │   │   └── interceptors/
│   │   │   └── main.ts
│   ├── web/          # React web (placeholder)
│   ├── mobile/       # React Native (placeholder)
│   └── admin/        # Backoffice React (placeholder)
├── packages/
│   ├── shared/       # Shared types/utilities
│   └── ui/           # Shared UI components (placeholder)
├── infrastructure/
│   └── docker/
│       └── docker-compose.yml
└── scripts/
```

### Database Models to Initialize
Initial Mongoose schemas needed [Source: architecture/data-models.md]:
1. **User Model** - With roles (super_admin, producer, sponsor, participant), profile, preferences
2. **Session Model** - With multilingual fields (title, description), speakers array, schedule info
3. **Speaker Model** - With bio, company, social links, highlight flag
4. **Sponsor Model** - With tier, logo, contact info, post limits

### Coding Standards to Enforce
Critical rules from architecture [Source: architecture/coding-standards.md]:
- **Type Sharing**: Define all types in packages/shared and import from there
- **Environment Variables**: Use SCREAMING_SNAKE_CASE (e.g., MONGODB_URI)
- **Database Collections**: Use PascalCase singular (e.g., User, Session, Speaker)
- **Database Fields**: Use camelCase (e.g., startTime, createdAt)
- **Never** access process.env directly - use config objects

### Testing Requirements

#### Testing Strategy [Source: architecture/testing-strategy.md]
- Test structure location: `apps/api/tests/` with subdirectories for unit/, integration/, e2e/
- Use Jest version 29+ with Supertest for API testing
- Test files should follow naming pattern: `*.spec.ts` or `*.test.ts`
- Coverage thresholds: Aim for 60% unit tests, 30% integration, 10% E2E

#### Initial Test Requirements
- Test MongoDB connection establishment and error handling
- Test environment variable loading and validation
- Test module initialization for each NestJS module
- Use mocking for external dependencies

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-26 | 1.0 | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record
*To be populated by development agent during implementation*

### Agent Model Used
*Pending*

### Debug Log References
*Pending*

### Completion Notes List
*Pending*

### File List
*Pending*

## QA Results
*To be populated by QA agent after implementation*