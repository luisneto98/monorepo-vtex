{"version":3,"names":["cov_u0kttfm2g","actualCoverage","common_1","s","require","core_1","roles_decorator_1","RolesGuard","reflector","constructor","f","canActivate","context","requiredRoles","getAllAndOverride","ROLES_KEY","getHandler","getClass","b","user","switchToHttp","getRequest","some","role","exports","__decorate","Injectable","Reflector"],"sources":["/home/luisneto98/Documentos/Code/monorepo-vtex/apps/api/src/modules/auth/guards/roles.guard.ts"],"sourcesContent":["import { Injectable, CanActivate, ExecutionContext } from '@nestjs/common';\nimport { Reflector } from '@nestjs/core';\nimport { ROLES_KEY } from '../decorators/roles.decorator';\n\n@Injectable()\nexport class RolesGuard implements CanActivate {\n  constructor(private reflector: Reflector) {}\n\n  canActivate(context: ExecutionContext): boolean {\n    const requiredRoles = this.reflector.getAllAndOverride<string[]>(ROLES_KEY, [\n      context.getHandler(),\n      context.getClass(),\n    ]);\n    if (!requiredRoles) {\n      return true;\n    }\n    const { user } = context.switchToHttp().getRequest();\n    return requiredRoles.some((role) => user.role === role);\n  }\n}\n"],"mappings":"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","ignoreList":[]}