{"version":3,"names":["DOMPurify","cov_2dcceyz0az","s","__importStar","require","SanitizationUtil","sanitizeHtml","html","f","sanitize","ALLOWED_TAGS","ALLOWED_ATTR","ALLOWED_URI_REGEXP","ALLOW_DATA_ATTR","KEEP_CONTENT","sanitizeText","text","trim","replace","sanitizeFilePath","path","sanitized","b","includes","Error","sanitizeSlug","toLowerCase","normalize","exports"],"sources":["/home/luisneto98/Documentos/Code/monorepo-vtex/apps/api/src/modules/news-releases/utils/sanitization.util.ts"],"sourcesContent":["import * as DOMPurify from 'isomorphic-dompurify';\n\nexport class SanitizationUtil {\n  static sanitizeHtml(html: string): string {\n    return DOMPurify.sanitize(html, {\n      ALLOWED_TAGS: [\n        'p',\n        'br',\n        'strong',\n        'em',\n        'u',\n        'a',\n        'ul',\n        'ol',\n        'li',\n        'blockquote',\n        'h1',\n        'h2',\n        'h3',\n        'h4',\n        'h5',\n        'h6',\n        'img',\n        'iframe',\n        'div',\n        'span',\n        'table',\n        'thead',\n        'tbody',\n        'tr',\n        'td',\n        'th',\n        'pre',\n        'code',\n      ],\n      ALLOWED_ATTR: [\n        'href',\n        'target',\n        'src',\n        'alt',\n        'width',\n        'height',\n        'frameborder',\n        'allowfullscreen',\n        'class',\n        'rel',\n        'title',\n      ],\n      ALLOWED_URI_REGEXP: /^(?:(?:https?|mailto):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i,\n      ALLOW_DATA_ATTR: false,\n      KEEP_CONTENT: true,\n    });\n  }\n\n  static sanitizeText(text: string): string {\n    return text?.trim().replace(/<[^>]*>?/gm, '');\n  }\n\n  static sanitizeFilePath(path: string): string {\n    // Remove any null bytes\n    let sanitized = path.replace(/\\0/g, '');\n\n    // Remove directory traversal attempts\n    sanitized = sanitized.replace(/\\.\\./g, '');\n\n    // Remove leading slashes\n    sanitized = sanitized.replace(/^\\/+/, '');\n\n    // Remove any control characters\n    sanitized = sanitized.replace(/[\\x00-\\x1f\\x80-\\x9f]/g, '');\n\n    // Normalize the path\n    sanitized = sanitized.replace(/\\/+/g, '/');\n\n    // Ensure no path traversal patterns remain\n    if (sanitized.includes('../') || sanitized.includes('..\\\\')) {\n      throw new Error('Invalid file path');\n    }\n\n    return sanitized;\n  }\n\n  static sanitizeSlug(text: string): string {\n    return text\n      .toLowerCase()\n      .normalize('NFD')\n      .replace(/[\\u0300-\\u036f]/g, '')\n      .replace(/[^a-z0-9]+/g, '-')\n      .replace(/^-+|-+$/g, '');\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}