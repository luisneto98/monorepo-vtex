{"version":3,"names":["cov_c2l3lbc95","actualCoverage","exports","sanitizeNotificationContent","s","sanitizeNotificationTitle","sanitizeNotification","sanitize_html_1","__importDefault","require","content","f","b","default","allowedTags","allowedAttributes","disallowedTagsMode","trim","title","sanitized","replace","notification","result","undefined","message"],"sources":["/home/luisneto98/Documentos/Code/monorepo-vtex/apps/api/src/common/utils/sanitize.util.ts"],"sourcesContent":["import sanitizeHtml from 'sanitize-html';\n\n/**\n * Sanitizes notification content to prevent XSS attacks\n * Removes all HTML tags and potentially harmful content\n * @param content - Raw user input content\n * @returns Sanitized safe content\n */\nexport function sanitizeNotificationContent(content: string): string {\n  if (!content) {\n    return '';\n  }\n\n  // Strip all HTML tags and scripts, keeping only plain text\n  return sanitizeHtml(content, {\n    allowedTags: [], // No HTML tags allowed\n    allowedAttributes: {}, // No attributes allowed\n    disallowedTagsMode: 'recursiveEscape', // Escape disallowed tags instead of stripping\n  }).trim();\n}\n\n/**\n * Sanitizes notification title with strict rules\n * @param title - Raw user input title\n * @returns Sanitized safe title\n */\nexport function sanitizeNotificationTitle(title: string): string {\n  if (!title) {\n    return '';\n  }\n\n  // Strip all HTML and limit to plain text\n  const sanitized = sanitizeHtml(title, {\n    allowedTags: [],\n    allowedAttributes: {},\n    disallowedTagsMode: 'recursiveEscape',\n  }).trim();\n\n  // Remove any remaining special characters that could be used for injection\n  return sanitized.replace(/[<>\\\"'`]/g, '');\n}\n\n/**\n * Validates and sanitizes a complete notification object\n * @param notification - Notification data to sanitize\n * @returns Sanitized notification object\n */\nexport function sanitizeNotification(notification: {\n  title?: string;\n  message?: string;\n  [key: string]: any;\n}): { title?: string; message?: string; [key: string]: any } {\n  const result: any = { ...notification };\n\n  if (notification.title !== undefined) {\n    result.title = sanitizeNotificationTitle(notification.title);\n  }\n\n  if (notification.message !== undefined) {\n    result.message = sanitizeNotificationContent(notification.message);\n  }\n\n  return result;\n}\n"],"mappings":"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","ignoreList":[]}