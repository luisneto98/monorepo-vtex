{"file":"/home/luisneto98/Documentos/Code/monorepo-vtex/apps/api/src/modules/speakers/schemas/speaker.schema.ts","mappings":"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","names":[],"sources":["/home/luisneto98/Documentos/Code/monorepo-vtex/apps/api/src/modules/speakers/schemas/speaker.schema.ts"],"sourcesContent":["import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\nimport { Document, Schema as MongooseSchema } from 'mongoose';\nimport { Speaker as ISpeaker, SpeakerSocialLinks } from '@shared/types/speaker.types';\n\nexport type SpeakerDocument = Speaker & Document;\n\n@Schema({ _id: false })\nclass SocialLinks implements SpeakerSocialLinks {\n  @Prop({\n    match: /^https?:\\/\\/(www\\.)?linkedin\\.com\\/.+/,\n  })\n  linkedin?: string;\n\n  @Prop({\n    match: /^https?:\\/\\/(www\\.)?twitter\\.com\\/.+/,\n  })\n  twitter?: string;\n\n  @Prop({\n    match: /^https?:\\/\\/github\\.com\\/.+/,\n  })\n  github?: string;\n\n  @Prop({\n    match: /^https?:\\/\\/.+/,\n  })\n  website?: string;\n}\n\n@Schema({ _id: false })\nclass Bio {\n  @Prop({\n    required: true,\n    minlength: 100,\n    maxlength: 500,\n    trim: true,\n  })\n  'pt-BR': string;\n\n  @Prop({\n    required: true,\n    minlength: 100,\n    maxlength: 500,\n    trim: true,\n  })\n  'en': string;\n}\n\n@Schema({ _id: false })\nclass Position {\n  @Prop({\n    required: true,\n    trim: true,\n    maxlength: 100,\n  })\n  'pt-BR': string;\n\n  @Prop({\n    required: true,\n    trim: true,\n    maxlength: 100,\n  })\n  'en': string;\n}\n\n@Schema({ timestamps: true, collection: 'Speaker' })\nexport class Speaker implements Omit<ISpeaker, '_id'> {\n  @Prop({\n    required: true,\n    minlength: 3,\n    maxlength: 100,\n    trim: true,\n  })\n  name: string;\n\n  @Prop({\n    type: Bio,\n    required: true,\n  })\n  bio: {\n    'pt-BR': string;\n    en: string;\n  };\n\n  @Prop({\n    required: true,\n    match: /^https?:\\/\\/.+/,\n  })\n  photoUrl: string;\n\n  @Prop({\n    required: true,\n    maxlength: 100,\n    trim: true,\n  })\n  company: string;\n\n  @Prop({\n    type: Position,\n    required: true,\n  })\n  position: {\n    'pt-BR': string;\n    en: string;\n  };\n\n  @Prop({\n    type: SocialLinks,\n    default: {},\n  })\n  socialLinks: SpeakerSocialLinks;\n\n  @Prop({\n    default: 100,\n    min: 0,\n  })\n  priority: number;\n\n  @Prop({\n    default: false,\n  })\n  isHighlight: boolean;\n\n  @Prop({\n    default: true,\n    index: true,\n  })\n  isVisible: boolean;\n\n  @Prop({\n    type: Date,\n    default: null,\n  })\n  deletedAt?: Date;\n\n  @Prop({\n    type: MongooseSchema.Types.ObjectId,\n    ref: 'User',\n  })\n  deletedBy?: MongooseSchema.Types.ObjectId;\n\n  @Prop({\n    type: String,\n  })\n  deleteReason?: string;\n\n  @Prop({\n    type: [String],\n    default: [],\n  })\n  tags?: string[];\n}\n\nexport const SpeakerSchema = SchemaFactory.createForClass(Speaker);\n\n// Indexes\nSpeakerSchema.index({ name: 'text' });\nSpeakerSchema.index({ isVisible: 1, priority: 1 });\nSpeakerSchema.index({ isHighlight: 1 });\nSpeakerSchema.index({ company: 1 });\nSpeakerSchema.index({ priority: 1 });\nSpeakerSchema.index({ deletedAt: 1 });\nSpeakerSchema.index({ tags: 1 });\n\n// Pre-save middleware for data normalization\nSpeakerSchema.pre('save', function (next) {\n  if (this.name) {\n    this.name = this.name.trim();\n  }\n  if (this.company) {\n    this.company = this.company.trim();\n  }\n  if (this.bio) {\n    if (this.bio['pt-BR']) {\n      this.bio['pt-BR'] = this.bio['pt-BR'].trim();\n    }\n    if (this.bio['en']) {\n      this.bio['en'] = this.bio['en'].trim();\n    }\n  }\n  if (this.position) {\n    if (this.position['pt-BR']) {\n      this.position['pt-BR'] = this.position['pt-BR'].trim();\n    }\n    if (this.position['en']) {\n      this.position['en'] = this.position['en'].trim();\n    }\n  }\n  next();\n});\n\n// Virtual fields\nSpeakerSchema.virtual('displayPriority').get(function () {\n  return this.isHighlight ? 0 : this.priority;\n});\n\n// Schema methods\nSpeakerSchema.methods['getLocalizedBio'] = function (language: 'pt-BR' | 'en'): string {\n  return this['bio'][language] || this['bio']['pt-BR'];\n};\n\nSpeakerSchema.methods['getLocalizedPosition'] = function (language: 'pt-BR' | 'en'): string {\n  return this['position'][language] || this['position']['pt-BR'];\n};\n"],"version":3}