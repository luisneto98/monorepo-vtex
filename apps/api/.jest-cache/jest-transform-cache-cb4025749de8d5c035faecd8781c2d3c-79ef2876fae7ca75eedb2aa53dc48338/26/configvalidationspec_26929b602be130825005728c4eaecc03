857cf533438f8be619c94c6b8cc7d92c
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const configuration_1 = __importDefault(require("../../src/config/configuration"));
describe('Configuration Validation', () => {
    const originalEnv = process.env;
    beforeEach(() => {
        jest.resetModules();
        process.env = { ...originalEnv };
    });
    afterAll(() => {
        process.env = originalEnv;
    });
    describe('Application Config', () => {
        it('should use default port when PORT is not set', () => {
            delete process.env['PORT'];
            const config = (0, configuration_1.default)();
            expect(config.port).toBe(3000);
        });
        it('should use custom port when PORT is set', () => {
            process.env['PORT'] = '4000';
            const config = (0, configuration_1.default)();
            expect(config.port).toBe(4000);
        });
    });
    describe('Database Config', () => {
        it('should use default MongoDB URI when not set', () => {
            delete process.env['MONGODB_URI'];
            const config = (0, configuration_1.default)();
            expect(config.database.uri).toBe('mongodb://localhost:27017/vtexday26');
        });
        it('should use custom MongoDB URI when set', () => {
            process.env['MONGODB_URI'] = 'mongodb://custom:27017/test';
            const config = (0, configuration_1.default)();
            expect(config.database.uri).toBe('mongodb://custom:27017/test');
        });
    });
    describe('JWT Config', () => {
        it('should have JWT secret configuration', () => {
            const config = (0, configuration_1.default)();
            expect(config.jwt.secret).toBeDefined();
            expect(config.jwt.accessExpiration).toBeDefined();
        });
        it('should use custom JWT settings when provided', () => {
            process.env['JWT_SECRET'] = 'test-secret';
            process.env['JWT_ACCESS_EXPIRATION'] = '1d';
            const config = (0, configuration_1.default)();
            expect(config.jwt.secret).toBe('test-secret');
            expect(config.jwt.accessExpiration).toBe('1d');
        });
    });
    describe('Redis Config', () => {
        it('should have default Redis configuration', () => {
            const config = (0, configuration_1.default)();
            expect(config.redis.host).toBe('localhost');
            expect(config.redis.port).toBe(6379);
        });
        it('should use custom Redis settings when provided', () => {
            process.env['REDIS_HOST'] = 'redis.example.com';
            process.env['REDIS_PORT'] = '6380';
            process.env['REDIS_PASSWORD'] = 'secret';
            const config = (0, configuration_1.default)();
            expect(config.redis.host).toBe('redis.example.com');
            expect(config.redis.port).toBe(6380);
            expect(config.redis.password).toBe('secret');
        });
    });
    describe('CORS Config', () => {
        it('should have default CORS configuration', () => {
            const config = (0, configuration_1.default)();
            expect(config.cors.origin).toBeDefined();
        });
        it('should use custom CORS origin when provided', () => {
            process.env['CORS_ORIGIN'] = 'https://example.com';
            const config = (0, configuration_1.default)();
            expect(config.cors.origin).toBe('https://example.com');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvbHVpc25ldG85OC9Eb2N1bWVudG9zL0NvZGUvbW9ub3JlcG8tdnRleC9hcHBzL2FwaS90ZXN0cy91bml0L2NvbmZpZy52YWxpZGF0aW9uLnNwZWMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxtRkFBMkQ7QUFFM0QsUUFBUSxDQUFDLDBCQUEwQixFQUFFLEdBQUcsRUFBRTtJQUN4QyxNQUFNLFdBQVcsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDO0lBRWhDLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxJQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7UUFDcEIsT0FBTyxDQUFDLEdBQUcsR0FBRyxFQUFFLEdBQUcsV0FBVyxFQUFFLENBQUM7SUFDbkMsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsR0FBRyxFQUFFO1FBQ1osT0FBTyxDQUFDLEdBQUcsR0FBRyxXQUFXLENBQUM7SUFDNUIsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsb0JBQW9CLEVBQUUsR0FBRyxFQUFFO1FBQ2xDLEVBQUUsQ0FBQyw4Q0FBOEMsRUFBRSxHQUFHLEVBQUU7WUFDdEQsT0FBTyxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQzNCLE1BQU0sTUFBTSxHQUFHLElBQUEsdUJBQWEsR0FBRSxDQUFDO1lBQy9CLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2pDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHlDQUF5QyxFQUFFLEdBQUcsRUFBRTtZQUNqRCxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLE1BQU0sQ0FBQztZQUM3QixNQUFNLE1BQU0sR0FBRyxJQUFBLHVCQUFhLEdBQUUsQ0FBQztZQUMvQixNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNqQyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FB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LENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3JDLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUMvQyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGFBQWEsRUFBRSxHQUFHLEVBQUU7UUFDM0IsRUFBRSxDQUFDLHdDQUF3QyxFQUFFLEdBQUcsRUFBRTtZQUNoRCxNQUFNLE1BQU0sR0FBRyxJQUFBLHVCQUFhLEdBQUUsQ0FBQztZQUMvQixNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUMzQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw2Q0FBNkMsRUFBRSxHQUFHLEVBQUU7WUFDckQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUMsR0FBRyxxQkFBcUIsQ0FBQztZQUNuRCxNQUFNLE1BQU0sR0FBRyxJQUFBLHVCQUFhLEdBQUUsQ0FBQztZQUMvQixNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMscUJBQXFCLENBQUMsQ0FBQztRQUN6RCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvbHVpc25ldG85OC9Eb2N1bWVudG9zL0NvZGUvbW9ub3JlcG8tdnRleC9hcHBzL2FwaS90ZXN0cy91bml0L2NvbmZpZy52YWxpZGF0aW9uLnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNvbmZpZ3VyYXRpb24gZnJvbSAnLi4vLi4vc3JjL2NvbmZpZy9jb25maWd1cmF0aW9uJztcblxuZGVzY3JpYmUoJ0NvbmZpZ3VyYXRpb24gVmFsaWRhdGlvbicsICgpID0+IHtcbiAgY29uc3Qgb3JpZ2luYWxFbnYgPSBwcm9jZXNzLmVudjtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LnJlc2V0TW9kdWxlcygpO1xuICAgIHByb2Nlc3MuZW52ID0geyAuLi5vcmlnaW5hbEVudiB9O1xuICB9KTtcblxuICBhZnRlckFsbCgoKSA9PiB7XG4gICAgcHJvY2Vzcy5lbnYgPSBvcmlnaW5hbEVudjtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0FwcGxpY2F0aW9uIENvbmZpZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHVzZSBkZWZhdWx0IHBvcnQgd2hlbiBQT1JUIGlzIG5vdCBzZXQnLCAoKSA9PiB7XG4gICAgICBkZWxldGUgcHJvY2Vzcy5lbnZbJ1BPUlQnXTtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IGNvbmZpZ3VyYXRpb24oKTtcbiAgICAgIGV4cGVjdChjb25maWcucG9ydCkudG9CZSgzMDAwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdXNlIGN1c3RvbSBwb3J0IHdoZW4gUE9SVCBpcyBzZXQnLCAoKSA9PiB7XG4gICAgICBwcm9jZXNzLmVudlsnUE9SVCddID0gJzQwMDAnO1xuICAgICAgY29uc3QgY29uZmlnID0gY29uZmlndXJhdGlvbigpO1xuICAgICAgZXhwZWN0KGNvbmZpZy5wb3J0KS50b0JlKDQwMDApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRGF0YWJhc2UgQ29uZmlnJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdXNlIGRlZmF1bHQgTW9uZ29EQiBVUkkgd2hlbiBub3Qgc2V0JywgKCkgPT4ge1xuICAgICAgZGVsZXRlIHByb2Nlc3MuZW52WydNT05HT0RCX1VSSSddO1xuICAgICAgY29uc3QgY29uZmlnID0gY29uZmlndXJhdGlvbigpO1xuICAgICAgZXhwZWN0KGNvbmZpZy5kYXRhYmFzZS51cmkpLnRvQmUoJ21vbmdvZGI6Ly9sb2NhbGhvc3Q6MjcwMTcvdnRleGRheTI2Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHVzZSBjdXN0b20gTW9uZ29EQiBVUkkgd2hlbiBzZXQnLCAoKSA9PiB7XG4gICAgICBwcm9jZXNzLmVudlsnTU9OR09EQl9VUkknXSA9ICdtb25nb2RiOi8vY3VzdG9tOjI3MDE3L3Rlc3QnO1xuICAgICAgY29uc3QgY29uZmlnID0gY29uZmlndXJhdGlvbigpO1xuICAgICAgZXhwZWN0KGNvbmZpZy5kYXRhYmFzZS51cmkpLnRvQmUoJ21vbmdvZGI6Ly9jdXN0b206MjcwMTcvdGVzdCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnSldUIENvbmZpZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhdmUgSldUIHNlY3JldCBjb25maWd1cmF0aW9uJywgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmlnID0gY29uZmlndXJhdGlvbigpO1xuICAgICAgZXhwZWN0KGNvbmZpZy5qd3Quc2VjcmV0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGNvbmZpZy5qd3QuYWNjZXNzRXhwaXJhdGlvbikudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdXNlIGN1c3RvbSBKV1Qgc2V0dGluZ3Mgd2hlbiBwcm92aWRlZCcsICgpID0+IHtcbiAgICAgIHByb2Nlc3MuZW52WydKV1RfU0VDUkVUJ10gPSAndGVzdC1zZWNyZXQnO1xuICAgICAgcHJvY2Vzcy5lbnZbJ0pXVF9BQ0NFU1NfRVhQSVJBVElPTiddID0gJzFkJztcbiAgICAgIGNvbnN0IGNvbmZpZyA9IGNvbmZpZ3VyYXRpb24oKTtcbiAgICAgIGV4cGVjdChjb25maWcuand0LnNlY3JldCkudG9CZSgndGVzdC1zZWNyZXQnKTtcbiAgICAgIGV4cGVjdChjb25maWcuand0LmFjY2Vzc0V4cGlyYXRpb24pLnRvQmUoJzFkJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSZWRpcyBDb25maWcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYXZlIGRlZmF1bHQgUmVkaXMgY29uZmlndXJhdGlvbicsICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IGNvbmZpZ3VyYXRpb24oKTtcbiAgICAgIGV4cGVjdChjb25maWcucmVkaXMuaG9zdCkudG9CZSgnbG9jYWxob3N0Jyk7XG4gICAgICBleHBlY3QoY29uZmlnLnJlZGlzLnBvcnQpLnRvQmUoNjM3OSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHVzZSBjdXN0b20gUmVkaXMgc2V0dGluZ3Mgd2hlbiBwcm92aWRlZCcsICgpID0+IHtcbiAgICAgIHByb2Nlc3MuZW52WydSRURJU19IT1NUJ10gPSAncmVkaXMuZXhhbXBsZS5jb20nO1xuICAgICAgcHJvY2Vzcy5lbnZbJ1JFRElTX1BPUlQnXSA9ICc2MzgwJztcbiAgICAgIHByb2Nlc3MuZW52WydSRURJU19QQVNTV09SRCddID0gJ3NlY3JldCc7XG4gICAgICBjb25zdCBjb25maWcgPSBjb25maWd1cmF0aW9uKCk7XG4gICAgICBleHBlY3QoY29uZmlnLnJlZGlzLmhvc3QpLnRvQmUoJ3JlZGlzLmV4YW1wbGUuY29tJyk7XG4gICAgICBleHBlY3QoY29uZmlnLnJlZGlzLnBvcnQpLnRvQmUoNjM4MCk7XG4gICAgICBleHBlY3QoY29uZmlnLnJlZGlzLnBhc3N3b3JkKS50b0JlKCdzZWNyZXQnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NPUlMgQ29uZmlnJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGF2ZSBkZWZhdWx0IENPUlMgY29uZmlndXJhdGlvbicsICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IGNvbmZpZ3VyYXRpb24oKTtcbiAgICAgIGV4cGVjdChjb25maWcuY29ycy5vcmlnaW4pLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHVzZSBjdXN0b20gQ09SUyBvcmlnaW4gd2hlbiBwcm92aWRlZCcsICgpID0+IHtcbiAgICAgIHByb2Nlc3MuZW52WydDT1JTX09SSUdJTiddID0gJ2h0dHBzOi8vZXhhbXBsZS5jb20nO1xuICAgICAgY29uc3QgY29uZmlnID0gY29uZmlndXJhdGlvbigpO1xuICAgICAgZXhwZWN0KGNvbmZpZy5jb3JzLm9yaWdpbikudG9CZSgnaHR0cHM6Ly9leGFtcGxlLmNvbScpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9