{"version":3,"names":["cov_1xba12r8o8","actualCoverage","s","sanitization_util_1","require","SlugGeneratorUtil","generateUniqueSlug","text","model","existingId","f","baseSlug","SanitizationUtil","sanitizeSlug","slug","counter","query","b","_id","$ne","existing","findOne","exports"],"sources":["/home/luisneto98/Documentos/Code/monorepo-vtex/apps/api/src/modules/news-releases/utils/slug-generator.util.ts"],"sourcesContent":["import { Model } from 'mongoose';\nimport { SanitizationUtil } from './sanitization.util';\n\nexport class SlugGeneratorUtil {\n  static async generateUniqueSlug(\n    text: string,\n    model: Model<any>,\n    existingId?: string,\n  ): Promise<string> {\n    const baseSlug = SanitizationUtil.sanitizeSlug(text);\n    let slug = baseSlug;\n    let counter = 1;\n\n    while (true) {\n      const query: any = { slug };\n      if (existingId) {\n        query._id = { $ne: existingId };\n      }\n\n      const existing = await model.findOne(query);\n      if (!existing) {\n        return slug;\n      }\n\n      slug = `${baseSlug}-${counter}`;\n      counter++;\n    }\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAoBM;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAAAA,cAAA,GAAAE,CAAA;;;;;;;AAnBN,MAAAC,mBAAA;AAAA;AAAA,CAAAH,cAAA,GAAAE,CAAA,OAAAE,OAAA;AAEA,MAAaC,iBAAiB;EAC5B,aAAaC,kBAAkBA,CAC7BC,IAAY,EACZC,KAAiB,EACjBC,UAAmB;IAAA;IAAAT,cAAA,GAAAU,CAAA;IAEnB,MAAMC,QAAQ;IAAA;IAAA,CAAAX,cAAA,GAAAE,CAAA,OAAGC,mBAAA,CAAAS,gBAAgB,CAACC,YAAY,CAACN,IAAI,CAAC;IACpD,IAAIO,IAAI;IAAA;IAAA,CAAAd,cAAA,GAAAE,CAAA,OAAGS,QAAQ;IACnB,IAAII,OAAO;IAAA;IAAA,CAAAf,cAAA,GAAAE,CAAA,OAAG,CAAC;IAAC;IAAAF,cAAA,GAAAE,CAAA;IAEhB,OAAO,IAAI,EAAE;MACX,MAAMc,KAAK;MAAA;MAAA,CAAAhB,cAAA,GAAAE,CAAA,OAAQ;QAAEY;MAAI,CAAE;MAAC;MAAAd,cAAA,GAAAE,CAAA;MAC5B,IAAIO,UAAU,EAAE;QAAA;QAAAT,cAAA,GAAAiB,CAAA;QAAAjB,cAAA,GAAAE,CAAA;QACdc,KAAK,CAACE,GAAG,GAAG;UAAEC,GAAG,EAAEV;QAAU,CAAE;MACjC,CAAC;MAAA;MAAA;QAAAT,cAAA,GAAAiB,CAAA;MAAA;MAED,MAAMG,QAAQ;MAAA;MAAA,CAAApB,cAAA,GAAAE,CAAA,QAAG,MAAMM,KAAK,CAACa,OAAO,CAACL,KAAK,CAAC;MAAC;MAAAhB,cAAA,GAAAE,CAAA;MAC5C,IAAI,CAACkB,QAAQ,EAAE;QAAA;QAAApB,cAAA,GAAAiB,CAAA;QAAAjB,cAAA,GAAAE,CAAA;QACb,OAAOY,IAAI;MACb,CAAC;MAAA;MAAA;QAAAd,cAAA,GAAAiB,CAAA;MAAA;MAAAjB,cAAA,GAAAE,CAAA;MAEDY,IAAI,GAAG,GAAGH,QAAQ,IAAII,OAAO,EAAE;MAAC;MAAAf,cAAA,GAAAE,CAAA;MAChCa,OAAO,EAAE;IACX;EACF;;AACD;AAAAf,cAAA,GAAAE,CAAA;AAzBDoB,OAAA,CAAAjB,iBAAA,GAAAA,iBAAA","ignoreList":[]}