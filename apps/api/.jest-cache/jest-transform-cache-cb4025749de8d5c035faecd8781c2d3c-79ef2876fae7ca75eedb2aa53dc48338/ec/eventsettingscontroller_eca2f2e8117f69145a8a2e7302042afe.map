{"version":3,"names":["cov_1v1fdjjn21","actualCoverage","common_1","s","require","swagger_1","throttler_1","event_settings_service_1","update_event_settings_dto_1","jwt_auth_guard_1","roles_guard_1","roles_decorator_1","public_decorator_1","shared_1","EventSettingsController","eventSettingsService","constructor","f","getSettings","updateSettings","updateEventSettingsDto","req","user","userId","getPublicSettings","exports","__decorate","Get","UseGuards","JwtAuthGuard","ApiBearerAuth","ApiOperation","summary","ApiResponse","status","HttpStatus","OK","description","UNAUTHORIZED","Put","RolesGuard","Roles","UserRole","SUPER_ADMIN","FORBIDDEN","BAD_REQUEST","__param","Body","Request","UpdateEventSettingsDto","Object","Public","Throttle","default","limit","ttl","TOO_MANY_REQUESTS","ApiTags","Controller","EventSettingsService"],"sources":["/home/luisneto98/Documentos/Code/monorepo-vtex/apps/api/src/modules/event-settings/event-settings.controller.ts"],"sourcesContent":["import { Controller, Get, Put, Body, UseGuards, Request, HttpStatus } from '@nestjs/common';\nimport { ApiTags, ApiOperation, ApiResponse, ApiBearerAuth } from '@nestjs/swagger';\nimport { Throttle } from '@nestjs/throttler';\nimport { EventSettingsService } from './event-settings.service';\nimport { UpdateEventSettingsDto } from './dto/update-event-settings.dto';\nimport { JwtAuthGuard } from '../auth/guards/jwt-auth.guard';\nimport { RolesGuard } from '../auth/guards/roles.guard';\nimport { Roles } from '../auth/decorators/roles.decorator';\nimport { Public } from '../../common/decorators/public.decorator';\nimport { UserRole } from '@vtexday26/shared';\n\n@ApiTags('event-settings')\n@Controller('event-settings')\nexport class EventSettingsController {\n  constructor(private readonly eventSettingsService: EventSettingsService) {}\n\n  @Get()\n  @UseGuards(JwtAuthGuard)\n  @ApiBearerAuth()\n  @ApiOperation({ summary: 'Get event settings' })\n  @ApiResponse({\n    status: HttpStatus.OK,\n    description: 'Returns the current event settings',\n  })\n  @ApiResponse({\n    status: HttpStatus.UNAUTHORIZED,\n    description: 'Unauthorized',\n  })\n  async getSettings() {\n    return await this.eventSettingsService.getSettings();\n  }\n\n  @Put()\n  @UseGuards(JwtAuthGuard, RolesGuard)\n  @Roles(UserRole.SUPER_ADMIN)\n  @ApiBearerAuth()\n  @ApiOperation({ summary: 'Update event settings (Admin only)' })\n  @ApiResponse({\n    status: HttpStatus.OK,\n    description: 'Event settings have been successfully updated',\n  })\n  @ApiResponse({\n    status: HttpStatus.UNAUTHORIZED,\n    description: 'Unauthorized',\n  })\n  @ApiResponse({\n    status: HttpStatus.FORBIDDEN,\n    description: 'Forbidden - Admin role required',\n  })\n  @ApiResponse({\n    status: HttpStatus.BAD_REQUEST,\n    description: 'Invalid data provided',\n  })\n  async updateSettings(\n    @Body() updateEventSettingsDto: UpdateEventSettingsDto,\n    @Request() req: any,\n  ) {\n    return await this.eventSettingsService.updateSettings(updateEventSettingsDto, req.user.userId);\n  }\n\n  @Get('public')\n  @Public() // No authentication required\n  @Throttle({ default: { limit: 30, ttl: 60000 } }) // 30 requests per minute per IP\n  @ApiOperation({ summary: 'Get public event settings (no auth required)' })\n  @ApiResponse({\n    status: HttpStatus.OK,\n    description: 'Returns the public event settings',\n  })\n  @ApiResponse({\n    status: HttpStatus.TOO_MANY_REQUESTS,\n    description: 'Too many requests - rate limit exceeded',\n  })\n  async getPublicSettings() {\n    return await this.eventSettingsService.getPublicSettings();\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAAA;IAAAA,cAAA,YAAAA,CAAA;MAAA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","ignoreList":[]}